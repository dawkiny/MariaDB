<!DOCTYPE html>
<!-- saved from url=(0075)https://yj.gitbooks.io/mariadb-tutorial/content/c02_4_partition_design.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>파티션 설계 · MariaDB Tutorial</title>
        
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.1.1">
        <meta name="author" content="YJ&#39;s working tips for DA">
        
        
    
    <link rel="stylesheet" href="./파티션 설계 · MariaDB Tutorial_files/style.css">

    
            
                
                <link rel="stylesheet" href="./파티션 설계 · MariaDB Tutorial_files/plugin.css">
                
            
                
                <link rel="stylesheet" href="./파티션 설계 · MariaDB Tutorial_files/website.css">
                
            
                
                <link rel="stylesheet" href="./파티션 설계 · MariaDB Tutorial_files/search.css">
                
            
                
                <link rel="stylesheet" href="./파티션 설계 · MariaDB Tutorial_files/website(1).css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://yj.gitbooks.io/mariadb-tutorial/content/gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="https://yj.gitbooks.io/mariadb-tutorial/content/gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="https://yj.gitbooks.io/mariadb-tutorial/content/c03_0_trx.html">
    
    
    <link rel="prev" href="https://yj.gitbooks.io/mariadb-tutorial/content/c02_4_design_for_perf.html">
    

    </head>
    <body>
        
<div class="book without-animation with-summary font-size-2 font-family-1">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search">
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="https://www.gitbook.com/book/yj/mariadb-tutorial" target="_blank" class="custom-link">MariaDB Tutorial</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="https://yj.gitbooks.io/mariadb-tutorial/content/">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="c01_introduction.html">
            
                <a href="https://yj.gitbooks.io/mariadb-tutorial/content/c01_introduction.html">
            
                    
                    MariaDB 개요
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="c02_0_table_consideration.html">
            
                <a href="https://yj.gitbooks.io/mariadb-tutorial/content/c02_0_table_consideration.html">
            
                    
                    테이블 설계 고려사항
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="c02_1_storage_engine.html">
            
                <a href="https://yj.gitbooks.io/mariadb-tutorial/content/c02_1_storage_engine.html">
            
                    
                    주요 스토리지 엔진
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="c02_2_rowformat.html">
            
                <a href="https://yj.gitbooks.io/mariadb-tutorial/content/c02_2_rowformat.html">
            
                    
                    ROW_FORMAT
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="c02_3_rowsize_limit.html">
            
                <a href="https://yj.gitbooks.io/mariadb-tutorial/content/c02_3_rowsize_limit.html">
            
                    
                    ROW 사이즈 제한
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="c02_4_design_for_perf.html">
            
                <a href="https://yj.gitbooks.io/mariadb-tutorial/content/c02_4_design_for_perf.html">
            
                    
                    성능을 고려한 설계
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.5" data-path="c02_4_partition_design.html">
            
                <a href="https://yj.gitbooks.io/mariadb-tutorial/content/c02_4_partition_design.html">
            
                    
                    파티션 설계
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="c03_0_trx.html">
            
                <a href="https://yj.gitbooks.io/mariadb-tutorial/content/c03_0_trx.html">
            
                    
                    트랜잭션의 이해
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="c03_1_trx_isolation.html">
            
                <a href="https://yj.gitbooks.io/mariadb-tutorial/content/c03_1_trx_isolation.html">
            
                    
                    트랜잭션 격리수준(transaction isolation)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="c03_2_autocommit.html">
            
                <a href="https://yj.gitbooks.io/mariadb-tutorial/content/c03_2_autocommit.html">
            
                    
                    autocommit 여부
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="c03_3_meta_lock.html">
            
                <a href="https://yj.gitbooks.io/mariadb-tutorial/content/c03_3_meta_lock.html">
            
                    
                    Metadata Locking
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com/" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <a class="btn pull-left js-toolbar-action" aria-label="" href="https://yj.gitbooks.io/mariadb-tutorial/content/c02_4_partition_design.html#"><i class="fa fa-align-justify"></i></a><div class="dropdown pull-right  js-toolbar-action"><a class="btn toggle-dropdown" aria-label="Share" href="https://yj.gitbooks.io/mariadb-tutorial/content/c02_4_partition_design.html#"><i class="fa fa-share-alt"></i></a><div class="dropdown-menu dropdown-left"><div class="dropdown-caret"><span class="caret-outer"></span><span class="caret-inner"></span></div><div class="buttons"><button class="button size-5 ">Facebook</button><button class="button size-5 ">Google+</button><button class="button size-5 ">Twitter</button><button class="button size-5 ">Weibo</button><button class="button size-5 ">Instapaper</button></div></div></div><a class="btn pull-right js-toolbar-action" aria-label="" href="https://yj.gitbooks.io/mariadb-tutorial/content/c02_4_partition_design.html#"><i class="fa fa-facebook"></i></a><a class="btn pull-right js-toolbar-action" aria-label="" href="https://yj.gitbooks.io/mariadb-tutorial/content/c02_4_partition_design.html#"><i class="fa fa-twitter"></i></a><div class="dropdown pull-left font-settings js-toolbar-action"><a class="btn toggle-dropdown" aria-label="Font Settings" href="https://yj.gitbooks.io/mariadb-tutorial/content/c02_4_partition_design.html#"><i class="fa fa-font"></i></a><div class="dropdown-menu dropdown-right"><div class="dropdown-caret"><span class="caret-outer"></span><span class="caret-inner"></span></div><div class="buttons"><button class="button size-2 font-reduce">A</button><button class="button size-2 font-enlarge">A</button></div><div class="buttons"><button class="button size-2 ">Serif</button><button class="button size-2 ">Sans</button></div><div class="buttons"><button class="button size-3 ">White</button><button class="button size-3 ">Sepia</button><button class="button size-3 ">Night</button></div></div></div><h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="https://yj.gitbooks.io/mariadb-tutorial/content/">파티션 설계</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="파티션-설계">파티션 설계</h2>
<h3 id="파티션-사용을-고려해야-할-상황">파티션 사용을 고려해야 할 상황</h3>
<ul>
<li>파티션 테이블은 단일 테이블 사이즈가 20G 이상이 예상될 때 고려하는 것이 좋다.</li>
<li>일반적으로 이력/내역과 같이 장기간 데이터를 보관하는 테이블에 대해서 보관주기를 설정하고, 날짜를 기준으로 RANGE PARTITION으로 구성하는 것을 권장한다.</li>
<li>각 파티션별로 저장될 파일을 따로 지정할 수 있으므로 물리적인 저장소 분리가 필요할 때도 고려해볼 수 있다.</li>
<li>과다한 INSERT가 발생하는 테이블에 대해서는 SUBPARTITION (혹은 PARTITION레벨)에서 HASH나 KEY형식의 파티션을 생성하여 INSERT 경합에 따른 INDEX LATCH나 Mutex 락을 최소화하도록 한다</li>
</ul>
<h3 id="파티션-제약">파티션 제약</h3>
<ul>
<li>파티셔닝 키는 반드시 PK에 포함되어야 한다.</li>
<li>Max partition 개수는 8192개이다. (subpartition 수 포함)</li>
<li>추가 제약조건(유니크 속성)을 부여할 수 없다.</li>
<li>Innodb partition 테이블에는 foreign key 생성을 할 수 없다.</li>
<li>FullText Index를 지원하지 않으며, Temporary table은 파티션 생성이 블가하다.</li>
<li>Subpartition은 HASH/KEY PARTITION만 지원한다.</li>
<li>파티션 테이블 ALTER명령어시 DML은 LOCKING된다. (ONLINE DDL수행하더라도 SELECT만 허용)</li>
<li>PARTITION TABLE생성후 SQL_MODE변경시 DATA corruption이나 loss 가 발생할 수 있다.</li>
<li>파티션 테이블의 인덱스는 모두 로컬 인덱스이다. 글로벌 인덱스는 지원하지 않는다.</li>
<li>파티션된 테이블에서 데이터는 파티션 내에서만 정렬이 된다.</li>
<li>AUTO_INCREMENT 속성을 갖는 테이블에서 파티션을 만들려면 파티션키가 되는 컬럼과 AUTO_INCREMENT 속성을 갖는 컬럼을 묶어서 PK로 생성해야 한다.</li>
<li>파티션키가 되는 컬럼에 NULL이 들어오면 해당 레코드는 가장 작은 파티션으로 들어간다.</li>
<li>파티션 키 값은 정수(INT)를 사용하는 것이 기본이지만 RANGE 파티션과 LIST 파티션에서는 "RANGE COLUMNS" 키워드를 사용하면 INT, STRING, DATE, DATETIME 타입을 그대로 파티션키로 사용할 수 있다.</li>
<li>PARTITION BY 표현식에 사용할 수 있는 함수들</li>
</ul>
<blockquote>
<p class="comments-section">ABS(), CEILING(), DAY(), DAYOFMONTH(), DAYOFWEEK(), DAYOFYEAR(), DATEDIFF(), EXTRACT(), FLOOR(), HOUR(), MICROSECOND(), MINUTE(), MOD(), MONTH(), QUARTER(), SECOND(), TIME_TO_SEC(), TO_DAYS(), WEEKDAY(), YEAR(), YEARWEEK()<div class="comments-icon"><div class="marker">+</div></div></p>
</blockquote>
<h3 id="파티션-타입">파티션 타입</h3>
<ul>
<li>RANGE 파티션 타입</li>
</ul>
<p class="comments-section">범위에 따라 파티션을 설정하는 방법<div class="comments-icon"><div class="marker">+</div></div></p>
<pre><code>예) 월단위 파티션을 갖는 테이블 생성
CREATE TABLE `test`.`tab_partition` 
(
 `seq` int unsigned auto_increment not null,
 `regist_dt` datetime not null default current_timestamp,
 `contents` varchar(1000),
 PRIMARY KEY (`seq`, `regist_dt`)
)
ENGINE=InnoDB DEFAULT CHARSET=utf8
PARTITION BY RANGE COLUMNS (regist_dt)
(
PARTITION p201601 VALUES LESS THAN ('2016-02-01 00:00:00'),
PARTITION p201602 VALUES LESS THAN ('2016-03-01 00:00:00'),
PARTITION p201603 VALUES LESS THAN ('2016-04-01 00:00:00'),
PARTITION pmaxvalues VALUES LESS THAN MAXVALUE
);
</code></pre><pre><code>예) 날짜타입을 갖는 테이블에서 연단위 파티션을 갖는 테이블 생성
CREATE TABLE `test`.`tab_partition` 
(
 `seq` int unsigned auto_increment not null,
 `regist_dt` datetime not null default current_timestamp,
 `contents` varchar(1000),
 PRIMARY KEY (`seq`, `regist_dt`)
)
ENGINE=InnoDB DEFAULT CHARSET=utf8
PARTITION BY RANGE (YEAR(regist_dt))
(
PARTITION p2014 VALUES LESS THAN (2015),
PARTITION p2015 VALUES LESS THAN (2016),
PARTITION p2016 VALUES LESS THAN (2017),
PARTITION pmaxvalues VALUES LESS THAN MAXVALUE
);
</code></pre><ul>
<li>LIST 파티션 타입</li>
</ul>
<p class="comments-section">목록에 따라 파티션을 설정하는 방법<div class="comments-icon"><div class="marker">+</div></div></p>
<pre><code>예)
CREATE TABLE `test`.`tab_partition` 
(
 `seq` int unsigned auto_increment not null,
 `region_cd` varchar(10) not null,
 `regist_dt` datetime not null default current_timestamp,
 `contents` varchar(1000),
 PRIMARY KEY (`seq`, `region_cd`)
)
ENGINE=InnoDB DEFAULT CHARSET=utf8
PARTITION BY LIST COLUMNS (`region_cd`)
(
PARTITION p_asia VALUES IN ('KOREA', 'CHINA'),
PARTITION p_europe VALUES IN ('FRANCE', 'ITALIA'),
PARTITION p_america VALUES IN ('CANADA', 'USA'),
PARTITION p_other VALUES IN (NULL)
);
</code></pre><ul>
<li>HASH 파티션 타입</li>
</ul>
<p class="comments-section">파티션은 필요하지만 파티션할 기간이나 특정 값의 집합을 정의하기 모호할 때 사용하는 파티션 타입이다.<div class="comments-icon"><div class="marker">+</div></div></p>
<pre><code>예)
CREATE TABLE `test`.`tab_partition` 
(
 `seq` int unsigned auto_increment not null,
 `regist_dt` datetime not null default current_timestamp,
 `contents` varchar(1000),
 PRIMARY KEY (`seq`, `regist_dt`)
)
ENGINE=InnoDB DEFAULT CHARSET=utf8
PARTITION BY HASH (TO_DAYS(regist_dt))
PARTITIONS 12;
</code></pre><h3 id="partition-pruning의-한계">Partition Pruning의 한계</h3>
<p class="comments-section">Partition Pruning 이란? 조건에 부합하는 파티션만 선택적으로 사용하게 하는 기능<div class="comments-icon"><div class="marker">+</div></div></p>
<ul>
<li>명시적으로 파티션키에 해당하는 실제 값을 정의해야만 특정 파티션을 선택한다.</li>
<li>RANGE, REF, EQ_REF 등올 조인시 해당 정보를 기준으로 특정 파티션을 선택하지 못한다.</li>
</ul>
<table>
<thead>
<tr>
<th>조인방식</th>
<th>설명</th>
</tr>
</thead>
<tbody>
<tr>
<td>RANGE</td>
<td>=, &lt;&gt;, &gt;, &gt;=, &lt;, &lt;=, IS NULL, BETWEEN, IN 연산자를 사용한 비교/범위 검색</td>
</tr>
<tr>
<td>REF</td>
<td>PRIMARY KEY 또는 UNIQUE INDEX가 아닌 일반적인 인덱스를 활용한 JOIN</td>
</tr>
<tr>
<td>EQ_REF</td>
<td>PRIMARY KEY 또는 UNIQUE INDEX를 활용한 JOIN</td>
</tr>
</tbody>
</table>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class="search-results-count"></span> results matching "<span class="search-query"></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class="search-query"></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="https://yj.gitbooks.io/mariadb-tutorial/content/c02_4_design_for_perf.html" class="navigation navigation-prev " aria-label="Previous page: 성능을 고려한 설계">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="https://yj.gitbooks.io/mariadb-tutorial/content/c03_0_trx.html" class="navigation navigation-next " aria-label="Next page: 트랜잭션의 이해" style="margin-right: 17px;">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script async="" src="./파티션 설계 · MariaDB Tutorial_files/analytics.js.다운로드"></script><script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"파티션 설계","level":"1.3.5","depth":2,"next":{"title":"트랜잭션의 이해","level":"1.4","depth":1,"path":"c03_0_trx.md","ref":"c03_0_trx.md","articles":[{"title":"트랜잭션 격리수준(transaction isolation)","level":"1.4.1","depth":2,"path":"c03_1_trx_isolation.md","ref":"c03_1_trx_isolation.md","articles":[]},{"title":"autocommit 여부","level":"1.4.2","depth":2,"path":"c03_2_autocommit.md","ref":"c03_2_autocommit.md","articles":[]},{"title":"Metadata Locking","level":"1.4.3","depth":2,"path":"c03_3_meta_lock.md","ref":"c03_3_meta_lock.md","articles":[]}]},"previous":{"title":"성능을 고려한 설계","level":"1.3.4","depth":2,"path":"c02_4_design_for_perf.md","ref":"c02_4_design_for_perf.md","articles":[]},"dir":"ltr"},"config":{"plugins":["comment"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"comment":{"highlightCommented":true},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"YJ's working tips for DA","pdf":{"pageNumbers":true,"fontSize":16,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"MariaDB Tutorial","language":"en","links":{"sidebar":{"MariaDB Tutorial":"https://www.gitbook.com/book/yj/mariadb-tutorial"},"gitbook":true},"gitbook":"*","description":"MariaDB Tutorial\r\n본 문서는 MariaDB에 익숙하지 않는 개발자 및 운영자, 사용자를 대상으로 MariaDB의 주요 특성과 SQL 작성에 필요한 정보를 제공하기 위한 문서이다."},"file":{"path":"c02_4_partition_design.md","mtime":"2016-07-03T04:04:51.000Z","type":"markdown"},"gitbook":{"version":"3.1.1","time":"2016-07-03T04:05:07.922Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="./파티션 설계 · MariaDB Tutorial_files/gitbook.js.다운로드"></script>
    <script src="./파티션 설계 · MariaDB Tutorial_files/theme.js.다운로드"></script>
    
        
        <script src="./파티션 설계 · MariaDB Tutorial_files/plugin.js.다운로드"></script>
        
    
        
        <script src="./파티션 설계 · MariaDB Tutorial_files/search-engine.js.다운로드"></script>
        
    
        
        <script src="./파티션 설계 · MariaDB Tutorial_files/search.js.다운로드"></script>
        
    
        
        <script src="./파티션 설계 · MariaDB Tutorial_files/lunr.min.js.다운로드"></script>
        
    
        
        <script src="./파티션 설계 · MariaDB Tutorial_files/search-lunr.js.다운로드"></script>
        
    
        
        <script src="./파티션 설계 · MariaDB Tutorial_files/buttons.js.다운로드"></script>
        
    
        
        <script src="./파티션 설계 · MariaDB Tutorial_files/fontsettings.js.다운로드"></script>
        
    

    
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57505611-7', 'auto');
  ga('send', 'pageview');

</script>



</body></html>